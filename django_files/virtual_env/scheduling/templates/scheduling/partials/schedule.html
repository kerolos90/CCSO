{% load scheduling_extras %}

<div class="col-xl-6 col-lg-4">
  <div class="card shadow">
    <div class="card-body">
      <div id="external-events" class="">
        <div class="d-flex justify-content-between">
          <button
            type="submit"
            class="btn btn-danger shadow"
            data-bs-toggle="modal"
            data-bs-target="#timeOffModal"
          >
            Time Off Request
          </button>
          <button
            type="submit"
            class="btn btn-light"
            data-bs-toggle="modal"
            data-bs-target="#editScheduleModal"
          >
            Edit Schedule
          </button>
        </div>
        <h1 class="text-center">Date</h1>
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="day-tab"
              data-bs-toggle="tab"
              data-bs-target="#day"
              type="button"
              role="tab"
              aria-controls="day-tab"
              aria-selected="true"
            >
              Day Shift
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="night-tab"
              data-bs-toggle="tab"
              data-bs-target="#night"
              type="button"
              role="tab"
              aria-controls="night-tab"
              aria-selected="false"
            >
              Night Shift
            </button>
          </li>
        </ul>

        <div class="tab-content" id="myTabContent">
          <div
            class="tab-pane fade show active"
            id="day"
            role="tabpanel"
            aria-labelledby="day-tab"
          >
            <br />
            <table class="table table-bordered shadow" style="text-align: center" >
              <thead>
                <tr>
                  <th width="30%" scope="col" colspan="2" style="text-align:center">Beat:</th>
                  <th width="23%" scope="col">0600-1000</th>
                  <th width="23%" scope="col">1000-1400</th>
                  <th width="23%" scope="col">1400-1800</th>
                </tr>
              </thead>
              <tbody hx-target="closest tr" hx-swap="outerHTML">
                {% for key, value in beats.items %}
                <tr id="{{key}}">
                    <td width="5%" >
                        <button
                        type="submit"
                        class="btn btn-light"
                        hx-get="{% url 'edit_schedule' key %}"
                        >
                        Edit
                        </button>
                    </td>
                    <th scope="row">{{value}}</th>
                    {% with "_first_four _second_four _third_four" as blocks %}
                        {% for block in blocks.split  %}
                        {% with key|addstr:block as block_attr %}
                            <td>{{test_date|get_attribute:block_attr}}</td>
                        {% endwith %}     
                        {% endfor %}
                    {% endwith %}
                </tr>
                {% endfor %}
              </tbody>
            </table>

            <table class="table table-bordered shadow">
              <thead>
                <tr>
                  <th scope="col">Beat:</th>
                  <th scope="col">0700-1100</th>
                  <th scope="col">1100-1500</th>
                  <th scope="col">1500-1900</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Savoy</th>
                  <td>Dep. Pryor #521</td>
                  <td>None</td>
                  <td>None</td>
                </tr>
                <tr>
                  <th scope="row">St. Joseph</th>
                  <td>None</td>
                  <td>None</td>
                  <td>Dep. Metlzer #519</td>
                </tr>
              </tbody>
            </table>
            <table class="table table-bordered shadow">
              <thead>
                <tr>
                  <th scope="col">Beat:</th>
                  <th scope="col">0600-1100</th>
                  <th scope="col">1100-1600</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Civil Service</th>
                  <td>Dep. Bialescki #510</td>
                  <td>Dep. Bialescki #510</td>
                </tr>
                <tr>
                  <th scope="row">Civil Service</th>
                  <td>Dep. Atwood #507</td>
                  <td>Dep. Atwood #507</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div
            class="tab-pane fade"
            id="night"
            role="tabpanel"
            aria-labelledby="night-tab"
          >
            <br />
            <table class="table table-bordered table-dark shadow">
              <thead>
                <tr>
                  <th scope="col">Beat:</th>
                  <th scope="col">1800-2200</th>
                  <th scope="col">2200-0200</th>
                  <th scope="col">0200-0600</th>
                </tr>
              </thead>
              <tbody >
                <tr>
                  <td>Test</td>
                  <td>Test</td>
                  <td>
                    <button class="btn btn-danger"
                            hx-get="{% url 'edit_schedule' %}"
                      Edit
                    </button>
                  </td>
                </tr>
              </tbody>

            </table>

            <table class="table table-bordered table-dark shadow">
              <thead>
                <tr>
                  <th scope="col">Beat:</th>
                  <th scope="col">1500-1900</th>
                  <th scope="col">1900-2300</th>
                  <th scope="col">2300-0300</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Savoy</th>
                  <td>Dep. Poor #521</td>
                  <td>None</td>
                  <td>None</td>
                </tr>
                <tr>
                  <th scope="row">St. Joseph</th>
                  <td>None</td>
                  <td>None</td>
                  <td>Dep. Metlzer #519</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
